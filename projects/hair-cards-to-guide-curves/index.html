<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Hair Cards to Guide Curves | James Robinson 🌊</title><meta name=keywords content="houdini,tools,hair"><meta name=description content="Convert hair card geometry (like from a game engine) to guide curves"><meta name=author content><link rel=canonical href=https://www.jamesrobinsonvfx.com/projects/hair-cards-to-guide-curves/><link crossorigin=anonymous href=/assets/css/stylesheet.c18f0e70982d46e72f09a1b9c081ddb26b145e34778ccbb832592b0ab8dcbd67.css integrity="sha256-wY8OcJgtRucvCaG5wIHdsmsUXjR3jMu4MlkrCrjcvWc=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://www.jamesrobinsonvfx.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.jamesrobinsonvfx.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://www.jamesrobinsonvfx.com/favicon-32x32.png><link rel=apple-touch-icon href=https://www.jamesrobinsonvfx.com/apple-touch-icon.png><link rel=mask-icon href=https://www.jamesrobinsonvfx.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><link rel=icon href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>🌊</text></svg>"><meta property="og:title" content="Hair Cards to Guide Curves"><meta property="og:description" content="Convert hair card geometry (like from a game engine) to guide curves"><meta property="og:type" content="article"><meta property="og:url" content="https://www.jamesrobinsonvfx.com/projects/hair-cards-to-guide-curves/"><meta property="og:image" content="https://www.jamesrobinsonvfx.com/projects/hair-cards-to-guide-curves/images/preview.png"><meta property="article:section" content="projects"><meta property="article:published_time" content="2021-09-08T00:00:00+00:00"><meta property="article:modified_time" content="2021-09-08T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.jamesrobinsonvfx.com/projects/hair-cards-to-guide-curves/images/preview.png"><meta name=twitter:title content="Hair Cards to Guide Curves"><meta name=twitter:description content="Convert hair card geometry (like from a game engine) to guide curves"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Projects 🪛","item":"https://www.jamesrobinsonvfx.com/projects/"},{"@type":"ListItem","position":3,"name":"Hair Cards to Guide Curves","item":"https://www.jamesrobinsonvfx.com/projects/hair-cards-to-guide-curves/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Hair Cards to Guide Curves","name":"Hair Cards to Guide Curves","description":"Convert hair card geometry (like from a game engine) to guide curves","keywords":["houdini","tools","hair"],"articleBody":"Overview A few weeks ago, my friend and co-worker Omar Taher came to me with an issue: he had a hair groom made of triangulated cards, and wanted to extract centerline curves from them to use as guides.\nGet it Download the latest release here.\nFull repo here.\nInside the houdini18.5/hda folder you can grab the HDA and put it someplace where Houdini will find it. Otherwise, you can install it as a Houdini Package:\nDownload the release zip Navigate to your Houdini user preferences folder (ie. ~/houdini18.5) Create a folder called packages if it doesn’t exist yet Copy the downloaded zip into packages Extract the contents, and delete the zip archive if you want Drag the file cards_to_curves.json up one level into to that packages folder There is also a demo file located at houdini18.5/hip with some usage examples.\nSee the the help card on the node for more detailed info.\nProcess Sounds easy enough at first, but given some wonky polygon winding and shapes, it took a little extra work to make sure it was stable on every card.\nFirst Attempt At first, not knowing much about how groom artists create hair cards, I took a VEX approach that matched up pairs of points based on their neighbors, and added a point at their center.\nUnfortunately, that only worked when the cards were made with one row of alternating triangles, and after downloading a few more free hair card grooms, I realized that this method fails spectacularly if the artist created it differently.\nFinal Luckily, one thing all good hair card grooms have in common: they have nice UVs! Should have thought of that sooner! This makes finding the centerline a breeze:\nEvaluate the connectivity. Split geo by UV seams, and promote uv attribute to points (if it isn’t there already). Swap P for UV, so the points now look like a UV layout, but in world space near the origin in the viewport. Iterate over each connected piece (card), and create a line down the center of the bounding box, from the top to the bottom. Add some more points to these lines with a Resample. Ray the lines to the flattened hair card geo. Use an Attribute Interpolate to put them back into world space. Checkout the hipfile to see the setup, and crack open the hda for a deeper look.\nTool Features As mentioned above, this node will create guide curves from hair cards.\nSome different grooms\nBy default, the tool is pretty straight forward. Plug in the static cards into the first input, get curves out! As long as you have a uv attribute (that works) you should get something useable.\nSingle Card \u0026 Guide Geometry Single Card\nEnable the Single Card parameter to scrub through the cards one at a time for a quick debugging visualization.\nStick to Animation If a second input is connected, the guides will interpolate attributes (including position) from that geometry stream.\nMake sure the topology matches the original cards from the first input!\nStick to Animation\nExploded View\nCaveats If you’re getting bad guides that zig zag, or look like they’re spanning across multiple guides, make sure the input cards are clean. There is a Poly Doctor embedded in the node that should help clean up non-manifold geometry, but sometimes it can’t do all the work! Make sure that any problem cards are actually being treated as separate connected islands per-card. Otherwise either fix them, or delete them!\nConclusion Enjoy! If you have any problems, please feel welcome to add an issue to the github repo, or reach out to me directly.\nHairstyles\n","wordCount":"605","inLanguage":"en","image":"https://www.jamesrobinsonvfx.com/projects/hair-cards-to-guide-curves/images/preview.png","datePublished":"2021-09-08T00:00:00Z","dateModified":"2021-09-08T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.jamesrobinsonvfx.com/projects/hair-cards-to-guide-curves/"},"publisher":{"@type":"Organization","name":"James Robinson 🌊","logo":{"@type":"ImageObject","url":"https://www.jamesrobinsonvfx.com/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.jamesrobinsonvfx.com accesskey=h title="James Robinson 🌊 (Alt + H)">James Robinson 🌊</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://www.jamesrobinsonvfx.com title="blog 🪶"><span>blog 🪶</span></a></li><li><a href=https://www.jamesrobinsonvfx.com/projects title="projects 🪛"><span>projects 🪛</span></a></li><li><a href=https://www.jamesrobinsonvfx.com/snippets title="snippets 🧰"><span>snippets 🧰</span></a></li><li><a href=https://www.jamesrobinsonvfx.com/links title="links 🔗"><span>links 🔗</span></a></li><li><a href=https://www.jamesrobinsonvfx.com/about title="about 👋"><span>about 👋</span></a></li><li><a href=https://www.jamesrobinsonvfx.com/search/ title="search 🔍"><span>search 🔍</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Hair Cards to Guide Curves</h1><div class=post-meta><span title='2021-09-08 00:00:00 +0000 UTC'>September 8, 2021</span>&nbsp;·&nbsp;3 min</div></header><figure class=entry-cover><a href=https://www.jamesrobinsonvfx.com/projects/hair-cards-to-guide-curves/images/preview.png target=_blank rel="noopener noreferrer"><img loading=lazy srcset="https://www.jamesrobinsonvfx.com/projects/hair-cards-to-guide-curves/images/preview_hu767af2021bb6a3ecaaff46f5476afbe9_389484_360x0_resize_box_3.png 360w ,https://www.jamesrobinsonvfx.com/projects/hair-cards-to-guide-curves/images/preview_hu767af2021bb6a3ecaaff46f5476afbe9_389484_480x0_resize_box_3.png 480w ,https://www.jamesrobinsonvfx.com/projects/hair-cards-to-guide-curves/images/preview_hu767af2021bb6a3ecaaff46f5476afbe9_389484_720x0_resize_box_3.png 720w ,https://www.jamesrobinsonvfx.com/projects/hair-cards-to-guide-curves/images/preview_hu767af2021bb6a3ecaaff46f5476afbe9_389484_1080x0_resize_box_3.png 1080w ,https://www.jamesrobinsonvfx.com/projects/hair-cards-to-guide-curves/images/preview.png 1090w" sizes="(min-width: 768px) 720px, 100vw" src=https://www.jamesrobinsonvfx.com/projects/hair-cards-to-guide-curves/images/preview.png alt="Cover Photo" width=1090 height=609></a><p>Hair Cards to Guide Curves</p></figure><div class=post-content><h2 id=overview>Overview<a hidden class=anchor aria-hidden=true href=#overview>🔗</a></h2><p>A few weeks ago, my friend and co-worker <a href=https://www.artstation.com/omartaher>Omar Taher</a> came to me with an issue: he had a hair groom made of triangulated cards, and wanted to extract centerline curves from them to use as guides.</p><h2 id=get-it>Get it<a hidden class=anchor aria-hidden=true href=#get-it>🔗</a></h2><p>Download the latest release <a href=https://github.com/jamesrobinsonvfx/cards_to_curves/releases/latest/download/cards_to_curves.zip>here</a>.</p><p>Full repo <a href=https://github.com/jamesrobinsonvfx/cards_to_curves>here</a>.</p><p>Inside the <code>houdini18.5/hda</code> folder you can grab the HDA and put it someplace where Houdini will find it. Otherwise, you can install it as a <a href=https://www.sidefx.com/docs/houdini/ref/plugins.html>Houdini Package</a>:</p><ol><li>Download the release zip</li><li>Navigate to your Houdini user preferences folder (ie. <code>~/houdini18.5</code>)</li><li>Create a folder called <code>packages</code> if it doesn&rsquo;t exist yet</li><li>Copy the downloaded zip into <code>packages</code></li><li>Extract the contents, and delete the zip archive if you want</li><li>Drag the file <code>cards_to_curves.json</code> up one level into to that <code>packages</code> folder</li></ol><p>There is also a demo file located at <code>houdini18.5/hip</code> with some usage examples.</p><p>See the the help card on the node for more detailed info.</p><h2 id=process>Process<a hidden class=anchor aria-hidden=true href=#process>🔗</a></h2><p>Sounds easy enough at first, but given some wonky polygon winding and shapes, it took a little extra work to make sure it was stable on every card.</p><h3 id=first-attempt>First Attempt<a hidden class=anchor aria-hidden=true href=#first-attempt>🔗</a></h3><p>At first, not knowing much about how groom artists create hair cards, I took a VEX approach that matched up pairs of points based on their neighbors, and added a point at their center.</p><p>Unfortunately, that only worked when the cards were made with one row of alternating triangles, and after downloading a few more free hair card grooms, I realized that this method fails spectacularly if the artist created it differently.</p><h3 id=final>Final<a hidden class=anchor aria-hidden=true href=#final>🔗</a></h3><p>Luckily, one thing all good hair card grooms have in common: they have nice UVs!
Should have thought of that sooner! This makes finding the centerline a breeze:</p><ol><li>Evaluate the connectivity.</li><li>Split geo by UV seams, and promote <code>uv</code> attribute to points (if it isn&rsquo;t
there already).</li><li><strong>Swap</strong> <code>P</code> for <code>UV</code>, so the points now look like a UV layout, but in world
space near the origin in the viewport.</li><li>Iterate over each connected piece (card), and create a line down the center
of the bounding box, from the top to the bottom.</li><li>Add some more points to these lines with a <strong>Resample</strong>.</li><li><strong>Ray</strong> the lines to the flattened hair card geo.</li><li>Use an <strong>Attribute Interpolate</strong> to put them back into world space.</li></ol><p>Checkout the hipfile to see the setup, and crack open the hda for a deeper look.</p><h2 id=tool-features>Tool Features<a hidden class=anchor aria-hidden=true href=#tool-features>🔗</a></h2><p>As mentioned above, this node will create guide curves from hair cards.</p><figure><img loading=lazy src=images/cycle-grooms.gif alt="Some different grooms"><figcaption><p>Some different grooms</p></figcaption></figure><p>By default, the tool is pretty straight forward. Plug in the static cards into the first input, get curves out! As long as you have a <code>uv</code> attribute (that works) you should get something useable.</p><h3 id=single-card--guide-geometry>Single Card & Guide Geometry<a hidden class=anchor aria-hidden=true href=#single-card--guide-geometry>🔗</a></h3><figure><img loading=lazy src=images/single-card.gif alt="Single Card"><figcaption><p>Single Card</p></figcaption></figure><p>Enable the <strong>Single Card</strong> parameter to scrub through the cards one at a time for a quick debugging visualization.</p><h3 id=stick-to-animation>Stick to Animation<a hidden class=anchor aria-hidden=true href=#stick-to-animation>🔗</a></h3><p>If a second input is connected, the guides will interpolate attributes (including position) from that geometry stream.</p><blockquote><p>Make sure the topology matches the original cards from the first input!</p></blockquote><figure><img loading=lazy src=images/stick-to-anim.gif alt="Stick to Animation"><figcaption><p>Stick to Animation</p></figcaption></figure><figure><img loading=lazy src=images/exploded-view.gif alt="Exploded View"><figcaption><p>Exploded View</p></figcaption></figure><h3 id=caveats>Caveats<a hidden class=anchor aria-hidden=true href=#caveats>🔗</a></h3><p>If you&rsquo;re getting bad guides that zig zag, or look like they&rsquo;re spanning across multiple guides, make sure the input cards are clean. There is a <strong>Poly Doctor</strong> embedded in the node that should help clean up non-manifold geometry, but sometimes it can&rsquo;t do all the work! Make sure that any problem cards are actually being treated as separate connected islands per-card. Otherwise either fix them, or delete them!</p><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>🔗</a></h2><p>Enjoy! If you have any problems, please feel welcome to add an issue to the github repo, or reach out to me directly.</p><figure><img loading=lazy src=images/change-hair.gif alt=Hairstyles><figcaption><p>Hairstyles</p></figcaption></figure></div><footer class=post-footer><ul class=post-tags><li><a href=https://www.jamesrobinsonvfx.com/tags/houdini/>houdini</a></li><li><a href=https://www.jamesrobinsonvfx.com/tags/tools/>tools</a></li><li><a href=https://www.jamesrobinsonvfx.com/tags/hair/>hair</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://www.jamesrobinsonvfx.com>James Robinson 🌊</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script src=https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script>const images=Array.from(document.querySelectorAll(".post-content img"));images.forEach(e=>{mediumZoom(e,{margin:0,scrollOffset:40,container:null,template:null,background:"rgba(0, 0, 0, 0.8)"})})</script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>